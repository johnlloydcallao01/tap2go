"use strict";(()=>{var e={};e.id=2110,e.ids=[2110],e.modules={3295:e=>{e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},10846:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},11723:e=>{e.exports=require("querystring")},11997:e=>{e.exports=require("punycode")},27910:e=>{e.exports=require("stream")},29021:e=>{e.exports=require("fs")},29294:e=>{e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},33873:e=>{e.exports=require("path")},34631:e=>{e.exports=require("tls")},44870:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},46954:(e,t,r)=>{r.r(t),r.d(t,{patchFetch:()=>v,routeModule:()=>m,serverHooks:()=>y,workAsyncStorage:()=>x,workUnitAsyncStorage:()=>f});var o={};r.r(o),r.d(o,{OPTIONS:()=>g,POST:()=>c,dynamic:()=>u,runtime:()=>l});var s=r(96559),i=r(48088),a=r(37719),n=r(32190),p=r(81234);let l="nodejs",u="force-dynamic",d=["image/jpeg","image/jpg","image/png","image/webp","image/gif","video/mp4","video/mov","video/avi","video/webm","application/pdf","application/msword","application/vnd.openxmlformats-officedocument.wordprocessingml.document"];async function c(e){try{console.log("\uD83D\uDCE4 Upload request received"),console.log("Content-Type:",e.headers.get("content-type"));let t=await e.formData();console.log("\uD83D\uDCCB FormData parsed successfully");let r=t.get("file");if(console.log("\uD83D\uDCC1 File from FormData:",r?`${r.name} (${r.size} bytes)`:"No file"),!r)return n.NextResponse.json({error:"No file provided"},{status:400});let o=r.size>0xa00000?"File size too large. Maximum size is 10MB":d.includes(r.type)?null:`File type not allowed. Allowed types: ${d.join(", ")}`;if(o)return n.NextResponse.json({error:o},{status:400});let s={folder:t.get("folder")?.toString(),tags:t.get("tags")?.toString().split(",").filter(Boolean),alt_text:t.get("alt_text")?.toString(),caption:t.get("caption")?.toString(),description:t.get("description")?.toString(),title:t.get("title")?.toString(),visibility:t.get("visibility")?.toString()||"public",uploaded_by:t.get("uploaded_by")?.toString()||"anonymous"};if(!s.uploaded_by||"anonymous"===s.uploaded_by)return n.NextResponse.json({error:"uploaded_by is required"},{status:400});let i=p.H.getInstance(),a=await i.uploadFile(r,s);return n.NextResponse.json({success:!0,message:"File uploaded successfully",data:a})}catch(t){console.error("Media upload error:",t);let e=t instanceof Error?t.message:"Upload failed";return n.NextResponse.json({error:"Upload failed",message:e},{status:500})}}async function g(){return new n.NextResponse(null,{status:200,headers:{"Access-Control-Allow-Origin":"*","Access-Control-Allow-Methods":"POST, OPTIONS","Access-Control-Allow-Headers":"Content-Type"}})}let m=new s.AppRouteRouteModule({definition:{kind:i.RouteKind.APP_ROUTE,page:"/api/media/upload/route",pathname:"/api/media/upload",filename:"route",bundlePath:"app/api/media/upload/route"},resolvedPagePath:"C:\\Users\\ACER\\Desktop\\tap2go\\apps\\web\\src\\app\\api\\media\\upload\\route.ts",nextConfigOutput:"",userland:o}),{workAsyncStorage:x,workUnitAsyncStorage:f,serverHooks:y}=m;function v(){return(0,a.patchFetch)({workAsyncStorage:x,workUnitAsyncStorage:f})}},55511:e=>{e.exports=require("crypto")},55591:e=>{e.exports=require("https")},63033:e=>{e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},74075:e=>{e.exports=require("zlib")},79428:e=>{e.exports=require("buffer")},79551:e=>{e.exports=require("url")},81630:e=>{e.exports=require("http")},91645:e=>{e.exports=require("net")},94735:e=>{e.exports=require("events")}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),o=t.X(0,[4447,580,4202,3259],()=>r(46954));module.exports=o})();