"use strict";(()=>{var e={};e.id=9091,e.ids=[9091],e.modules={2502:e=>{e.exports=import("prettier/plugins/html")},3295:e=>{e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},6943:(e,r,t)=>{t.a(e,async(e,s)=>{try{t.r(r),t.d(r,{GET:()=>p,POST:()=>u});var a=t(32190),o=t(84421),n=t(51271),i=t(61120),d=e([o,n]);[o,n]=d.then?(await d)():d;let l=new Map;async function u(e){try{let r,t=(0,o.fY)();if(!t.valid)return a.NextResponse.json({success:!1,error:"Email service configuration error",details:t.errors},{status:500});let{type:s,data:d,recipients:u}=await e.json(),p=e.headers.get("x-forwarded-for")||"unknown";if(!function(e){let r=Date.now(),t=l.get(e);return!t||r>t.resetTime?(l.set(e,{count:1,resetTime:r+6e4}),!0):!(t.count>=10)&&(t.count++,!0)}(p))return a.NextResponse.json({success:!1,error:"Rate limit exceeded. Please try again later."},{status:429});if(!s||!d||!u)return a.NextResponse.json({success:!1,error:"Missing required fields: type, data, recipients"},{status:400});switch(s){case"order_confirmation":r={to:u,subject:`Order Confirmation - #${d.orderNumber}`,template:i.createElement(n.q,{customerName:d.customerName,orderId:d.orderId,orderNumber:d.orderNumber,restaurantName:d.restaurantName,items:d.items,subtotal:d.subtotal,deliveryFee:d.deliveryFee,tax:d.tax,total:d.total,estimatedDeliveryTime:d.estimatedDeliveryTime,deliveryAddress:d.deliveryAddress,paymentMethod:d.paymentMethod,trackingUrl:d.trackingUrl}),type:"order_confirmation",metadata:{orderId:d.orderId,customerId:d.customerId,restaurantId:d.restaurantId}};break;case"welcome":r={to:u,subject:"Welcome to Tap2Go! \uD83C\uDF89",template:i.createElement("div",{},i.createElement("h1",{},`Welcome to Tap2Go, ${d.name}!`),i.createElement("p",{},"Thank you for joining our food delivery platform."),i.createElement("p",{},"Start exploring restaurants in your area and enjoy fast, reliable delivery.")),type:"welcome",metadata:{userId:d.userId,userRole:d.role}};break;case"password_reset":r={to:u,subject:"Reset Your Tap2Go Password",template:i.createElement("div",{},i.createElement("h1",{},"Password Reset Request"),i.createElement("p",{},`Hi ${d.name},`),i.createElement("p",{},"You requested to reset your password. Click the link below to create a new password:"),i.createElement("a",{href:d.resetUrl,style:{backgroundColor:"#f97316",color:"white",padding:"12px 24px",textDecoration:"none",borderRadius:"6px",display:"inline-block",margin:"16px 0"}},"Reset Password"),i.createElement("p",{},"This link will expire in 1 hour."),i.createElement("p",{},"If you didn't request this, please ignore this email.")),type:"password_reset",metadata:{userId:d.userId,resetToken:d.resetToken}};break;case"order_status_update":r={to:u,subject:`Order Update - #${d.orderNumber}`,template:i.createElement("div",{},i.createElement("h1",{},"Order Status Update"),i.createElement("p",{},`Hi ${d.customerName},`),i.createElement("p",{},`Your order #${d.orderNumber} status has been updated:`),i.createElement("p",{style:{fontSize:"18px",fontWeight:"bold",color:"#f97316"}},d.status),i.createElement("p",{},d.message||"We'll keep you updated on any further changes."),d.trackingUrl&&i.createElement("a",{href:d.trackingUrl,style:{backgroundColor:"#f97316",color:"white",padding:"12px 24px",textDecoration:"none",borderRadius:"6px",display:"inline-block",margin:"16px 0"}},"Track Order")),type:"order_status_update",metadata:{orderId:d.orderId,status:d.status,customerId:d.customerId}};break;default:return a.NextResponse.json({success:!1,error:`Unsupported email type: ${s}`},{status:400})}let c=await (0,o.ZM)(r);if(c.success)return a.NextResponse.json({success:!0,messageId:c.messageId,metadata:c.metadata});return a.NextResponse.json({success:!1,error:c.error,metadata:c.metadata},{status:500})}catch(e){return console.error("Email API error:",e),a.NextResponse.json({success:!1,error:"Internal server error",details:e instanceof Error?e.message:"Unknown error"},{status:500})}}async function p(){let e=(0,o.fY)();return a.NextResponse.json({status:"ok",emailService:{enabled:"true"===process.env.ENABLE_EMAIL_NOTIFICATIONS,configured:e.valid,errors:e.errors},timestamp:new Date().toISOString()})}s()}catch(e){s(e)}})},10846:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},27910:e=>{e.exports=require("stream")},28354:e=>{e.exports=require("util")},29294:e=>{e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},30763:(e,r,t)=>{t.a(e,async(e,s)=>{try{t.r(r),t.d(r,{patchFetch:()=>u,routeModule:()=>p,serverHooks:()=>m,workAsyncStorage:()=>l,workUnitAsyncStorage:()=>c});var a=t(96559),o=t(48088),n=t(37719),i=t(6943),d=e([i]);i=(d.then?(await d)():d)[0];let p=new a.AppRouteRouteModule({definition:{kind:o.RouteKind.APP_ROUTE,page:"/api/email/send/route",pathname:"/api/email/send",filename:"route",bundlePath:"app/api/email/send/route"},resolvedPagePath:"C:\\Users\\ACER\\Desktop\\tap2go\\apps\\web\\src\\app\\api\\email\\send\\route.ts",nextConfigOutput:"",userland:i}),{workAsyncStorage:l,workUnitAsyncStorage:c,serverHooks:m}=p;function u(){return(0,n.patchFetch)({workAsyncStorage:l,workUnitAsyncStorage:c})}s()}catch(e){s(e)}})},44870:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},55511:e=>{e.exports=require("crypto")},57075:e=>{e.exports=require("node:stream")},63033:e=>{e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},83505:e=>{e.exports=import("prettier/standalone")},84297:e=>{e.exports=require("async_hooks")}};var r=require("../../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),s=r.X(0,[4447,580,2720,7727],()=>t(30763));module.exports=s})();