(()=>{var e={};e.id=3331,e.ids=[3331],e.modules={588:(e,t,r)=>{"use strict";r.a(e,async(e,s)=>{try{r.d(t,{G7:()=>c,Qk:()=>d,db:()=>u});var i=r(9801),a=r(7879),o=r(14276),n=e([i,a,o]);[i,a,o]=n.then?(await n)():n;let l=null,c=null,d=null;!function(){try{if((0,i.getApps)().length>0){l=(0,i.getApps)().find(e=>"admin"===e.name)||(0,i.getApps)()[0],c=(0,a.getFirestore)(l),d=(0,o.getAuth)(l);return}let e=process.env.FIREBASE_ADMIN_PROJECT_ID,t=process.env.FIREBASE_ADMIN_PRIVATE_KEY,r=process.env.FIREBASE_ADMIN_CLIENT_EMAIL;if(!e||!t||!r)return void console.warn("Firebase Admin environment variables not found. Admin features will be disabled.");let s=t;s=(s=s.replace(/^["']|["']$/g,"")).replace(/\\n/g,"\n");let n={type:"service_account",project_id:e,private_key:s,client_email:r};l=(0,i.initializeApp)({credential:(0,i.cert)(n),projectId:e},"admin"),c=(0,a.getFirestore)(l),d=(0,o.getAuth)(l),console.log("Firebase Admin initialized successfully")}catch(e){console.error("Failed to initialize Firebase Admin:",e),l=null,c=null,d=null}}();let u=c;s()}catch(e){s(e)}})},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},7879:e=>{"use strict";e.exports=import("firebase-admin/firestore")},9801:e=>{"use strict";e.exports=import("firebase-admin/app")},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},10883:(e,t,r)=>{"use strict";r.a(e,async(e,s)=>{try{r.r(t),r.d(t,{patchFetch:()=>c,routeModule:()=>d,serverHooks:()=>m,workAsyncStorage:()=>u,workUnitAsyncStorage:()=>p});var i=r(96559),a=r(48088),o=r(37719),n=r(48417),l=e([n]);n=(l.then?(await l)():l)[0];let d=new i.AppRouteRouteModule({definition:{kind:a.RouteKind.APP_ROUTE,page:"/api/setup-admin/route",pathname:"/api/setup-admin",filename:"route",bundlePath:"app/api/setup-admin/route"},resolvedPagePath:"C:\\Users\\ACER\\Desktop\\tap2go\\apps\\web\\src\\app\\api\\setup-admin\\route.ts",nextConfigOutput:"",userland:n}),{workAsyncStorage:u,workUnitAsyncStorage:p,serverHooks:m}=d;function c(){return(0,o.patchFetch)({workAsyncStorage:u,workUnitAsyncStorage:p})}s()}catch(e){s(e)}})},14276:e=>{"use strict";e.exports=import("firebase-admin/auth")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},39283:(e,t,r)=>{"use strict";r.a(e,async(s,i)=>{try{r.d(t,{E:()=>c,I:()=>l});var a=r(588),o=r(7879);e=r.hmd(e);var n=s([a,o]);[a,o]=n.then?(await n)():n;let l=async()=>{let e="johnlloydcallao@gmail.com",t="123456",r="John Lloyd",s="Callao";try{let i;if(!a.Qk||!a.G7)throw Error("Firebase Admin not initialized. Please check your environment variables.");console.log("Setting up super admin user...");try{i=await a.Qk.getUserByEmail(e),console.log("Admin user already exists:",i.uid)}catch{console.log("Creating new admin user..."),i=await a.Qk.createUser({email:e,password:t,emailVerified:!0,displayName:`${r} ${s}`}),console.log("Admin user created:",i.uid)}await a.Qk.setCustomUserClaims(i.uid,{role:"admin",isSuperAdmin:!0}),console.log("Admin custom claims set");let n={email:e,firstName:r,lastName:s,role:"admin",status:"active",isSuperAdmin:!0,profile:{preferences:{notifications:!0,marketing:!1}},addresses:[],orderHistory:{totalOrders:0,totalSpent:0,averageOrderValue:0},updatedAt:o.FieldValue.serverTimestamp()},l=a.G7.collection("users").doc(i.uid);return(await l.get()).exists?(await l.update(n),console.log("Admin user document updated")):(await l.set({...n,createdAt:o.FieldValue.serverTimestamp()}),console.log("Admin user document created")),console.log("✅ Super admin setup completed successfully!"),console.log(`Email: ${e}`),console.log(`Password: ${t}`),console.log(`UID: ${i.uid}`),{success:!0,uid:i.uid,email:e}}catch(e){throw console.error("❌ Error setting up super admin:",e),e}},c=async()=>{try{if(!a.Qk||!a.G7)throw Error("Firebase Admin not initialized. Please check your environment variables.");let e=await a.Qk.getUserByEmail("johnlloydcallao@gmail.com"),t=e.customClaims,r=await a.G7.collection("users").doc(e.uid).get();console.log("Admin verification:"),console.log("- UID:",e.uid),console.log("- Email:",e.email),console.log("- Email Verified:",e.emailVerified),console.log("- Custom Claims:",t),console.log("- Firestore Document Exists:",r.exists),r.exists&&console.log("- Document Data:",r.data());let s=t?.role==="admin"&&r.exists;return console.log("- Is Valid Admin:",s),{isValid:s,userRecord:e,customClaims:t,firestoreData:r.exists?r.data():null}}catch(e){return console.error("Error verifying admin setup:",e),{isValid:!1,error:e}}};r.c[r.s]===e&&l().then(()=>{console.log("Setup completed"),process.exit(0)}).catch(e=>{console.error("Setup failed:",e),process.exit(1)}),i()}catch(e){i(e)}})},44870:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},48417:(e,t,r)=>{"use strict";r.a(e,async(e,s)=>{try{r.r(t),r.d(t,{POST:()=>n});var i=r(32190),a=r(39283),o=e([a]);async function n(){try{let e=await (0,a.E)();if(e.isValid)return i.NextResponse.json({success:!0,message:"Super admin already exists and is properly configured",admin:{uid:e.userRecord?.uid,email:e.userRecord?.email,customClaims:e.customClaims}});let t=await (0,a.I)();return i.NextResponse.json({success:!0,message:"Super admin created successfully",admin:t})}catch(e){return console.error("Error setting up admin:",e),i.NextResponse.json({error:"Internal Server Error",message:"Failed to setup admin user"},{status:500})}}a=(o.then?(await o)():o)[0],s()}catch(e){s(e)}})},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},78335:()=>{},96487:()=>{}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[4447,580],()=>r(10883));module.exports=s})();