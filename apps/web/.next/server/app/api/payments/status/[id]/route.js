(()=>{var t={};t.id=2434,t.ids=[2434],t.modules={3295:t=>{"use strict";t.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},3395:(t,e,r)=>{"use strict";r.r(e),r.d(e,{patchFetch:()=>g,routeModule:()=>y,serverHooks:()=>_,workAsyncStorage:()=>l,workUnitAsyncStorage:()=>h});var a={};r.r(a),r.d(a,{DELETE:()=>m,GET:()=>c,POST:()=>p,PUT:()=>d});var s=r(96559),o=r(48088),n=r(37719),i=r(32190),u=r(38561);async function c(t,{params:e}){try{let{id:r}=await e,{searchParams:a}=new URL(t.url),s=a.get("client_key");if(!r)return i.NextResponse.json({error:"Payment Intent ID is required"},{status:400});let o=await u.w.getPaymentIntent(r,s||void 0);return i.NextResponse.json({success:!0,data:{id:o.data.id,status:o.data.attributes.status,amount:o.data.attributes.amount,currency:o.data.attributes.currency,description:o.data.attributes.description,next_action:o.data.attributes.next_action,last_payment_error:o.data.attributes.last_payment_error,payments:o.data.attributes.payments,created_at:o.data.attributes.created_at,updated_at:o.data.attributes.updated_at}})}catch(t){return console.error("Get Payment Intent Status API Error:",t),i.NextResponse.json({error:"Failed to get payment intent status",details:t instanceof Error?t.message:"Unknown error"},{status:500})}}async function p(){return i.NextResponse.json({error:"Method not allowed"},{status:405})}async function d(){return i.NextResponse.json({error:"Method not allowed"},{status:405})}async function m(){return i.NextResponse.json({error:"Method not allowed"},{status:405})}let y=new s.AppRouteRouteModule({definition:{kind:o.RouteKind.APP_ROUTE,page:"/api/payments/status/[id]/route",pathname:"/api/payments/status/[id]",filename:"route",bundlePath:"app/api/payments/status/[id]/route"},resolvedPagePath:"C:\\Users\\ACER\\Desktop\\tap2go\\apps\\web\\src\\app\\api\\payments\\status\\[id]\\route.ts",nextConfigOutput:"",userland:a}),{workAsyncStorage:l,workUnitAsyncStorage:h,serverHooks:_}=y;function g(){return(0,n.patchFetch)({workAsyncStorage:l,workUnitAsyncStorage:h})}},10846:t=>{"use strict";t.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},12412:t=>{"use strict";t.exports=require("assert")},21820:t=>{"use strict";t.exports=require("os")},27910:t=>{"use strict";t.exports=require("stream")},28354:t=>{"use strict";t.exports=require("util")},29021:t=>{"use strict";t.exports=require("fs")},29294:t=>{"use strict";t.exports=require("next/dist/server/app-render/work-async-storage.external.js")},33873:t=>{"use strict";t.exports=require("path")},38561:(t,e,r)=>{"use strict";r.d(e,{w:()=>n});var a=r(55511),s=r.n(a),o=r(38985);class n{static async createPaymentIntent(t){try{if(!(0,o.hx)(t.amount))throw Error(`Payment amount must be between ₱20.00 and ₱999,999.99. Received: ₱${t.amount}`);let e={data:{attributes:{amount:(0,o.Zd)(t.amount),currency:t.currency||"PHP",description:t.description,statement_descriptor:t.statement_descriptor||"Tap2Go Food Delivery",payment_method_allowed:t.payment_method_allowed||(0,o.lx)(),payment_method_options:t.payment_method_options||{card:{request_three_d_secure:"automatic"}},metadata:{...t.metadata,platform:"tap2go",created_via:"api"}}}};return(await o.Ub.post("/payment_intents",e)).data}catch(t){throw console.error("PayMongo createPaymentIntent error:",t),Error((0,o.TF)(t))}}static async getPaymentIntent(t,e){try{let r=e?`/payment_intents/${t}?client_key=${e}`:`/payment_intents/${t}`,a=e?o.T7:o.Ub;return(await a.get(r)).data}catch(t){throw console.error("PayMongo getPaymentIntent error:",t),Error((0,o.TF)(t))}}static async createPaymentMethod(t){try{let e={data:{attributes:{type:t.type,details:t.details,billing:t.billing,metadata:{...t.metadata,platform:"tap2go"}}}};return(await o.T7.post("/payment_methods",e)).data}catch(t){throw console.error("PayMongo createPaymentMethod error:",t),Error((0,o.TF)(t))}}static async attachPaymentMethod(t){try{let e={data:{attributes:{payment_method:t.payment_method_id,client_key:t.client_key,return_url:t.return_url||`${process.env.NEXT_PUBLIC_APP_URL||"http://localhost:3000"}/payment/callback`}}};return(await o.T7.post(`/payment_intents/${t.payment_intent_id}/attach`,e)).data}catch(t){throw console.error("PayMongo attachPaymentMethod error:",t),Error((0,o.TF)(t))}}static async getPayment(t){try{return(await o.Ub.get(`/payments/${t}`)).data}catch(t){throw console.error("PayMongo getPayment error:",t),Error((0,o.TF)(t))}}static async listPayments(t){try{let e=new URLSearchParams;t?.before&&e.append("before",t.before),t?.after&&e.append("after",t.after),t?.limit&&e.append("limit",t.limit.toString());let r=`/payments${e.toString()?`?${e.toString()}`:""}`;return(await o.Ub.get(r)).data}catch(t){throw console.error("PayMongo listPayments error:",t),Error((0,o.TF)(t))}}static async createRefund(t,e,r){try{let a={data:{attributes:{payment_id:t,amount:e?(0,o.Zd)(e):void 0,reason:r||"requested_by_customer",metadata:{platform:"tap2go",refund_via:"api"}}}};return(await o.Ub.post("/refunds",a)).data}catch(t){throw console.error("PayMongo createRefund error:",t),Error((0,o.TF)(t))}}static verifyWebhookSignature(t,e,r){try{let a=s().createHmac("sha256",r).update(t).digest("hex");return s().timingSafeEqual(Buffer.from(e),Buffer.from(a))}catch(t){return console.error("PayMongo webhook signature verification error:",t),!1}}static getSupportedPaymentMethods(){return(0,o.lx)()}static validateAmount(t){return(0,o.hx)(t)}static convertToCentavos(t){return(0,o.Zd)(t)}static convertFromCentavos(t){return(0,o.Mk)(t)}}},38985:(t,e,r)=>{"use strict";r.d(e,{Mk:()=>d,T7:()=>i,TF:()=>c,Ub:()=>u,Zd:()=>p,hx:()=>m,lx:()=>y});var a=r(94612);let s=process.env.PAYMONGO_PUBLIC_KEY_LIVE,o=process.env.PAYMONGO_SECRET_KEY_LIVE,n=(t=!1)=>{let e=t?o:s;if(!e)throw Error(`PayMongo ${t?"secret":"public"} key is not configured. Please check your environment variables.`);let r=Buffer.from(`${e}:`).toString("base64");return a.A.create({baseURL:"https://api.paymongo.com/v1",headers:{Authorization:`Basic ${r}`,"Content-Type":"application/json",Accept:"application/json"},timeout:3e4})},i=n(!1),u=n(!0),c=t=>t.response?.data?.errors?t.response.data.errors.map(t=>t.detail).join(", "):t.message?t.message:"An unexpected error occurred with the payment gateway.",p=t=>Math.round(100*t),d=t=>t/100,m=t=>t>=20&&t<=999999.99,y=()=>["card","gcash","grab_pay","paymaya","billease","dob"]},44870:t=>{"use strict";t.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},55511:t=>{"use strict";t.exports=require("crypto")},55591:t=>{"use strict";t.exports=require("https")},63033:t=>{"use strict";t.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},74075:t=>{"use strict";t.exports=require("zlib")},78335:()=>{},79551:t=>{"use strict";t.exports=require("url")},81630:t=>{"use strict";t.exports=require("http")},83997:t=>{"use strict";t.exports=require("tty")},94735:t=>{"use strict";t.exports=require("events")},96487:()=>{}};var e=require("../../../../../webpack-runtime.js");e.C(t);var r=t=>e(e.s=t),a=e.X(0,[4447,580,5195,4612],()=>r(3395));module.exports=a})();