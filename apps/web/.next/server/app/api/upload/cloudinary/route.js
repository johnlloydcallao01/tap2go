(()=>{var e={};e.id=3352,e.ids=[3352],e.modules={3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},11723:e=>{"use strict";e.exports=require("querystring")},27910:e=>{"use strict";e.exports=require("stream")},29021:e=>{"use strict";e.exports=require("fs")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},33873:e=>{"use strict";e.exports=require("path")},44870:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},55511:e=>{"use strict";e.exports=require("crypto")},55591:e=>{"use strict";e.exports=require("https")},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},78335:()=>{},79551:e=>{"use strict";e.exports=require("url")},81630:e=>{"use strict";e.exports=require("http")},90800:(e,r,t)=>{"use strict";t.r(r),t.d(r,{patchFetch:()=>v,routeModule:()=>m,serverHooks:()=>x,workAsyncStorage:()=>f,workUnitAsyncStorage:()=>g});var s={};t.r(s),t.d(s,{OPTIONS:()=>c,POST:()=>l});var o=t(96559),a=t(48088),u=t(37719),n=t(32190);let i=async()=>{let{v2:e}=await t.e(1870).then(t.t.bind(t,71870,23));return e.config().cloud_name||e.config({cloud_name:"dpekh75yi",api_key:process.env.CLOUDINARY_API_KEY,api_secret:process.env.CLOUDINARY_API_SECRET,secure:!0}),e},p=(e,r)=>{let t={image:0xa00000,video:0x6400000,document:5242880};if(e.size>t[r]){let e=Math.round(t[r]/1048576);return`File size must be less than ${e}MB`}let s={image:["jpg","jpeg","png","webp","gif"],video:["mp4","mov","avi","mkv","webm"],document:["pdf","doc","docx","jpg","jpeg","png"]},o=e.name.split(".").pop()?.toLowerCase();return o&&s[r].includes(o)?null:`Supported formats: ${s[r].join(", ")}`},d=async e=>{let r=await e.arrayBuffer();return Buffer.from(r)};async function l(e){try{let r=await i(),t=await e.formData(),s=t.get("file"),o=t.get("uploadType");if(!s)return n.NextResponse.json({error:"No file provided"},{status:400});if(!o)return n.NextResponse.json({error:"Upload type is required"},{status:400});let a="video"===o?"video":"document"===o?"document":"image",u=p(s,a);if(u)return n.NextResponse.json({error:u},{status:400});let l=await d(s),c={resource_type:"video"===a?"video":"auto",quality:"auto",format:"auto"};switch(o){case"restaurant":{let e=t.get("restaurantId");if(!e)return n.NextResponse.json({error:"Restaurant ID is required"},{status:400});c.folder="restaurants",c.public_id=`restaurant_${e}_${Date.now()}`,c.tags=["restaurant","food-delivery"];break}case"menu-item":{let e=t.get("restaurantId"),r=t.get("menuItemId");if(!e)return n.NextResponse.json({error:"Restaurant ID is required"},{status:400});c.folder="menu-items",c.public_id=r?`menu_${e}_${r}`:`menu_${e}_${Date.now()}`,c.tags=["menu-item","food"];break}case"avatar":{let e=t.get("userId");if(!e)return n.NextResponse.json({error:"User ID is required"},{status:400});c.folder="avatars",c.public_id=`avatar_${e}`,c.tags=["avatar","user"],c.overwrite=!0;break}case"document":{let e=t.get("userId"),r=t.get("documentType");if(!e||!r)return n.NextResponse.json({error:"User ID and document type are required"},{status:400});c.folder="documents",c.public_id=`doc_${e}_${r}_${Date.now()}`,c.tags=["document",r];break}case"video":{let e=t.get("restaurantId"),r=t.get("videoType")||"promotional";if(!e)return n.NextResponse.json({error:"Restaurant ID is required"},{status:400});c.folder="videos",c.public_id=`video_${e}_${r}_${Date.now()}`,c.tags=["video",r],c.resource_type="video";break}default:return n.NextResponse.json({error:"Invalid upload type"},{status:400})}let m=new Promise((e,t)=>{r.uploader.upload_stream(c,(r,s)=>{r?t(r):e(s)}).end(l)}),f=await m;return n.NextResponse.json(f)}catch(r){console.error("Cloudinary upload error:",r);let e=r instanceof Error?r.message:"Upload failed";return n.NextResponse.json({error:e},{status:500})}}async function c(){return new n.NextResponse(null,{status:200,headers:{"Access-Control-Allow-Origin":"*","Access-Control-Allow-Methods":"POST, OPTIONS","Access-Control-Allow-Headers":"Content-Type"}})}let m=new o.AppRouteRouteModule({definition:{kind:a.RouteKind.APP_ROUTE,page:"/api/upload/cloudinary/route",pathname:"/api/upload/cloudinary",filename:"route",bundlePath:"app/api/upload/cloudinary/route"},resolvedPagePath:"C:\\Users\\ACER\\Desktop\\tap2go\\apps\\web\\src\\app\\api\\upload\\cloudinary\\route.ts",nextConfigOutput:"",userland:s}),{workAsyncStorage:f,workUnitAsyncStorage:g,serverHooks:x}=m;function v(){return(0,u.patchFetch)({workAsyncStorage:f,workUnitAsyncStorage:g})}},96487:()=>{}};var r=require("../../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),s=r.X(0,[4447,580],()=>t(90800));module.exports=s})();